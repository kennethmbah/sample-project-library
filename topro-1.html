<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Sample Projects Library : My tutorial, sample and template projects, mostly discussed in my blog and elsewhere.">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Sample Projects Library</title>

<style>	
	code {
   background: #EEE;
   text-shadow: none;
   box-shadow: none;
   font-size: 12px;
   border-radius: 0px;
    color: #222;
    font-family: Monaco,"Bitstream Vera Sans Mono","Lucida Console",Terminal,monospace;
    width: 100%;
	 padding: none;
	 margin: none;
}
</style>
	
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/imifos/sample-project-library">View on GitHub</a>

          <h1 id="project_title">Imifos' Sample Projects Library</h1>
          <h2 id="project_tagline">topro-1</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/imifos/sample-project-library/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/imifos/sample-project-library/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">

		<h3>Project: AngularJS, Jersey, JSP and Java EE 6</h3>
			
		
		
		
		<p>The "topro" project (short for "topic proposer", sorry I wasn't very inspired on this) is a test that I made to play around with AngularJS. In the opposite to a lot of AngularJS examples on the net, the project implements the entire chain: AngualarJS on the browser side, REST to communicate with the application server, JAX-RS/Jersey as server-side REST implementation, JSP as templating system of the server-side front-end, Java EE 6 for server-side back-end. The project demonstrates many different things, some of them enumerated hereunder.</p>
<p>The choice of using JSP technology for templating may seem strange at first sight. First of all raises the question if we still need server-side templating while having client-side templating with AngularJS. Realistically, the answer is yes when it comes to more complex applications. A lot of things are easier (and smarter) be done on the server before actually delivering the pages: translations, transforming data, security role handling et al.</p>
<p>Concerning JSP, one has to admit that, despite of its age, it's a great and proven technology. Pre-compiled into servlets, it's fast compared to other Servlet-based technologies and the JSTL library provides most of what a happy programmer needs to perform efficient templating. Custom Tags come to rescue if this should not be enough. Obviously, Java code in the JSP pages has to be banished. If this discipline is not there, better use PHP then :)</p>
<p>For simplification, the project doesn't use a database. Data is stored in a flat file de/serialised using the XStream library. You can pull the project and just run it (on Glassfish), without any installation.</p>
<p>The complete source code can be found here: <a href="https://github.com/imifos/sample-project-library/tree/master/topro-1" target="_blank">https://github.com/imifos/sample-project-library/tree/master/topro-1</a></p>
<p>Some things discussed in this project:</p>
<p><strong><em>*) How to use Jersey not only to implement REST based data resources, but also deliver (JSP) pages. This mechanism is not part of the Java EE 6 JAX-RS standard, but a Jersey specific implementation.</em></strong></p>
<p>See <a href="https://github.com/imifos/sample-project-library/blob/master/topro-1/src/main/webapp/WEB-INF/web.xml" target="_blank">web.xml</a> and <a href="https://github.com/imifos/sample-project-library/blob/master/topro-1/src/main/java/eu/lucubratory/topro1/front/res/page/MainPageResource.java" target="_blank">eu.lucubratory.topro1.front.res.page.MainPageResource</a></p>
<div><div id="highlighter_452180" class="syntaxhighlighter nogutter tca java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class=""><div class="container"><div class="line number1 index0 alt2"><code>@Path</code><code class="java plain">(</code><code class="java string">"/res/pages"</code><code class="java plain">)</code></div><div class="line number2 index1 alt1"><code class="java color1">@Produces</code><code class="java plain">(MediaType.TEXT_HTML)</code></div><div class="line number3 index2 alt2"><code class="java color1">@ManagedBean</code></div><div class="line number4 index3 alt1"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">MainPageResource {</code></div><div class="line number5 index4 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java color1">@GET</code></div><div class="line number6 index5 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Path</code><code class="java plain">(</code><code class="java string">"main"</code><code class="java plain">)</code></div><div class="line number7 index6 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java plain">Viewable index(</code><code class="java color1">@Context</code> <code class="java plain">HttpServletRequest request) {</code></div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">:</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java keyword">new</code> <code class="java plain">Viewable(</code><code class="java string">"/main.jsp"</code><code class="java plain">, </code><code class="java keyword">null</code><code class="java plain">);</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
<p><strong><em>*) How to configure Jersey in the web.xml file to differentiate REST from classic web server file accesses and how to define in which directory the JSP files are located. Since the WEB-INF directory is the only directory that cannot be accessed from the outside, this is the best place to store JSP files.</em></strong></p>
<p>See <a href="https://github.com/imifos/sample-project-library/blob/master/topro-1/src/main/webapp/WEB-INF/web.xml" target="_blank">web.xml</a></p>
<div><div id="highlighter_819106" class="syntaxhighlighter nogutter tca xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">filter</code><code class="xml plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">filter-name</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">jersey</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">filter-name</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">filter-class</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">com.sun.jersey.spi.container.servlet.ServletContainer</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">filter-class</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">init-param</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">&lt;!--&nbsp; "Viewable" JSP root is placed in the /WEB-INF/jsp directory.</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">This means that it's not accessible outside of the web app.</code></div><div class="line number11 index10 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">There's no way to construct a URL that can retrieve these files. --&gt;</code></div><div class="line number12 index11 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">param-name</code><code class="xml plain">&gt;</code></div><div class="line number13 index12 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">com.sun.jersey.config.property.JSPTemplatesBasePath</code></div><div class="line number14 index13 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">param-name</code><code class="xml plain">&gt;</code></div><div class="line number15 index14 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">param-value</code><code class="xml plain">&gt;</code></div><div class="line number16 index15 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">/WEB-INF/jsp</code></div><div class="line number17 index16 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">param-value</code><code class="xml plain">&gt;</code></div><div class="line number18 index17 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">init-param</code><code class="xml plain">&gt;</code></div><div class="line number19 index18 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">init-param</code><code class="xml plain">&gt;</code></div><div class="line number20 index19 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">&lt;!-- Declare what file type should be accessible thru Jersey without being interpreted as REST call.</code></div><div class="line number21 index20 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">Escape img, js, css folders and *.jsp, *.html, *.xhtml from the Jersey filter --&gt;</code></div><div class="line number22 index21 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">param-name</code><code class="xml plain">&gt;</code></div><div class="line number23 index22 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">com.sun.jersey.config.property.WebPageContentRegex</code></div><div class="line number24 index23 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">param-name</code><code class="xml plain">&gt;</code></div><div class="line number25 index24 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">param-value</code><code class="xml plain">&gt;</code></div><div class="line number26 index25 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">(/(img|js|css)/?.*)|(/.*\.jsp)|(/WEB-INF/.*\.jsp)|(/WEB-INF/.*\.jspf)|(/.*\.html)|</code></div><div class="line number27 index26 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">(/favicon\.ico)|(/robots\.txt)</code></div><div class="line number28 index27 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">param-value</code><code class="xml plain">&gt;</code></div><div class="line number29 index28 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">init-param</code><code class="xml plain">&gt;</code></div><div class="line number30 index29 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">init-param</code><code class="xml plain">&gt;</code></div><div class="line number31 index30 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">param-name</code><code class="xml plain">&gt;</code></div><div class="line number32 index31 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">com.sun.jersey.api.json.POJOMappingFeature</code></div><div class="line number33 index32 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">param-name</code><code class="xml plain">&gt;</code></div><div class="line number34 index33 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">param-value</code><code class="xml plain">&gt;true&lt;/</code><code class="xml keyword">param-value</code><code class="xml plain">&gt;</code></div><div class="line number35 index34 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">init-param</code><code class="xml plain">&gt;</code></div><div class="line number36 index35 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">init-param</code><code class="xml plain">&gt;</code></div><div class="line number37 index36 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">&lt;!-- Allow JAX-RS resources to use @RolesAllowed, @PermitAll and @DenyAll annotations (like EJBs) --&gt;</code></div><div class="line number38 index37 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">param-name</code><code class="xml plain">&gt;</code></div><div class="line number39 index38 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">com.sun.jersey.spi.container.ResourceFilters</code></div><div class="line number40 index39 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">param-name</code><code class="xml plain">&gt;</code></div><div class="line number41 index40 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">param-value</code><code class="xml plain">&gt;</code></div><div class="line number42 index41 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">com.sun.jersey.api.container.filter.RolesAllowedResourceFilterFactory</code></div><div class="line number43 index42 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">param-value</code><code class="xml plain">&gt;</code></div><div class="line number44 index43 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">init-param</code><code class="xml plain">&gt;</code></div><div class="line number45 index44 alt2"><code class="xml plain">&lt;/</code><code class="xml keyword">filter</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div>
<p><strong>*) <em>How to inject the org.codehaus.jackson library's ObjectMapper and how to customise the serialiser. The ObjectMapper is documented as idempotent and thread safe - the perfect singletone.</em></strong></p>
<p>See package <a href="https://github.com/imifos/sample-project-library/tree/master/topro-1/src/main/java/eu/lucubratory/topro1/front/common/json" target="_blank">eu.lucubratory.topro1.front.common.json</a></p>
<div><div id="highlighter_551207" class="syntaxhighlighter nogutter tca java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java color1">@Qualifier</code></div><div class="line number2 index1 alt1"><code class="java color1">@Target</code><code class="java plain">({ ElementType.TYPE, ElementType.METHOD, ElementType.FIELD,ElementType.PARAMETER })</code></div><div class="line number3 index2 alt2"><code class="java color1">@Retention</code><code class="java plain">(RetentionPolicy.RUNTIME)</code></div><div class="line number4 index3 alt1"><code class="java keyword">public</code> <code class="java color2">@interface</code> <code class="java plain">JsonMapper {</code></div><div class="line number5 index4 alt2"><code class="java plain">}</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">JsonMapperFactory </code><code class="java keyword">implements</code> <code class="java plain">Serializable {</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java keyword">static</code> <code class="java plain">ObjectMapper customisedJsonMapper=</code><code class="java keyword">null</code><code class="java plain">;</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java color1">@Produces</code> <code class="java color1">@JsonMapper</code> <code class="java plain">ObjectMapper getJsonMapper(InjectionPoint ip) {</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code> <code class="java plain">(customisedJsonMapper==</code><code class="java keyword">null</code><code class="java plain">) {</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">synchronized</code><code class="java plain">(JsonMapperFactory.</code><code class="java keyword">class</code><code class="java plain">) {</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code> <code class="java plain">(customisedJsonMapper==</code><code class="java keyword">null</code><code class="java plain">) {</code></div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">SimpleModule myModule = </code><code class="java keyword">new</code> <code class="java plain">SimpleModule(</code><code class="java string">"TOPRO1"</code><code class="java plain">,</code><code class="java keyword">new</code> <code class="java plain">Version(</code><code class="java value">1</code><code class="java plain">,</code><code class="java value">0</code><code class="java plain">,</code><code class="java value">0</code><code class="java plain">,</code><code class="java keyword">null</code><code class="java plain">));</code></div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">myModule.addSerializer(</code><code class="java keyword">new</code> <code class="java plain">ProposalTypeSerializer());</code></div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">customisedJsonMapper=</code><code class="java keyword">new</code> <code class="java plain">ObjectMapper();</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">customisedJsonMapper.registerModule(myModule);</code></div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java plain">customisedJsonMapper;</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number25 index24 alt2"><code class="java plain">:</code></div><div class="line number26 index25 alt1"><code class="java plain">}</code></div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">ProposalTypeSerializer </code><code class="java keyword">extends</code> <code class="java plain">SerializerBase&lt;ProposalTypes&gt; {</code></div><div class="line number29 index28 alt2">&nbsp;</div><div class="line number30 index29 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java plain">ProposalTypeSerializer() {</code></div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">super</code><code class="java plain">(ProposalTypes.</code><code class="java keyword">class</code><code class="java plain">, </code><code class="java keyword">true</code><code class="java plain">);</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number33 index32 alt2">&nbsp;</div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">void</code> <code class="java plain">serialize(ProposalTypes value, JsonGenerator jgen, SerializerProvider provider)</code></div><div class="line number36 index35 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">throws</code> <code class="java plain">IOException, JsonGenerationException {</code></div><div class="line number37 index36 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">jgen.writeString(Translator.translate(value));</code></div><div class="line number38 index37 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number39 index38 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
<p><strong><em>*) How to define data REST resources in JAX-RS (Jersey)</em></strong></p>
<p>See <a href="https://github.com/imifos/sample-project-library/blob/master/topro-1/src/main/java/eu/lucubratory/topro1/front/res/topic/TopicsResource.java" target="_blank">eu.lucubratory.topro1.front.res.topic.TopicsResource</a></p>
<div><div id="highlighter_711000" class="syntaxhighlighter nogutter tca java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java color1">@Path</code><code class="java plain">(</code><code class="java string">"/res/"</code><code class="java plain">)</code></div><div class="line number2 index1 alt1"><code class="java color1">@ManagedBean</code></div><div class="line number3 index2 alt2"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">TopicsResource {</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java color1">@POST</code></div><div class="line number6 index5 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Consumes</code><code class="java plain">(MediaType.APPLICATION_JSON)</code></div><div class="line number7 index6 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Path</code><code class="java plain">(</code><code class="java string">"/topics"</code><code class="java plain">)</code></div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">void</code> <code class="java plain">newTopic(</code><code class="java color1">@Context</code> <code class="java plain">HttpServletRequest request, ProposalEntity proposal) {</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code> <code class="java plain">{</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">...</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">catch</code> <code class="java plain">(ValidationException ex) {</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">...</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">catch</code> <code class="java plain">(SystemException ex) {</code></div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">throw</code> <code class="java keyword">new</code> <code class="java plain">WebApplicationException(Response.Status.INTERNAL_SERVER_ERROR);</code></div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number19 index18 alt2"><code class="java plain">:</code></div><div class="line number20 index19 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
<p><strong><em>*) How to use the 'ServiceFacade' and the 'Service' EJB patterns.</em></strong></p>
<p>See <a href="https://github.com/imifos/sample-project-library/tree/master/topro-1/src/main/java/eu/lucubratory/topro1/domain/topic" target="_blank">package eu.lucubratory.topro1.domain.topic</a></p>
<div><div id="highlighter_412569" class="syntaxhighlighter nogutter tca java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java color1">@Stateless</code></div><div class="line number2 index1 alt1"><code class="java color1">@LocalBean</code></div><div class="line number3 index2 alt2"><code class="java color1">@TransactionAttribute</code><code class="java plain">(TransactionAttributeType.REQUIRES_NEW)</code></div><div class="line number4 index3 alt1"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">TopicFacade {</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Inject</code> <code class="java plain">TopicService topicService;</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">void</code> <code class="java plain">newTopic(ProposalEntity topic) </code><code class="java keyword">throws</code> <code class="java plain">ValidationException, DatastoreFailureException {</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">topicService.newTopic(topic);</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number11 index10 alt2"><code class="java plain">}</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="java color1">@Stateless</code></div><div class="line number14 index13 alt1"><code class="java color1">@LocalBean</code></div><div class="line number15 index14 alt2"><code class="java color1">@TransactionAttribute</code><code class="java plain">(TransactionAttributeType.MANDATORY)</code></div><div class="line number16 index15 alt1"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">TopicService {</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">void</code> <code class="java plain">newTopic(ProposalEntity topic) </code><code class="java keyword">throws</code> <code class="java plain">ValidationException, DatastoreFailureException {</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">:</code></div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number21 index20 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Facades are thin transaction boundary beans and that always start a transaction which is then propagated to one or more services. The real power of this architecture becomes clear with more complex business operations distributed over multiple services.</p>
<p>Services are business logic EJBs that are executed inside of a transactions open by a Facade. Services handle business logic that is too broad to be placed directly in the concerned Entities. Services are never called by the front-end (this would trigger a transaction error), but always via a ServiceFacade.</p>
<p>On the client-side, we have...</p>
<p><strong><em>*) How to use an application level controller (cf. 'AppController') to store global configurations. This avoids "polluting" the '$rootScope' and allows to handle failed sub-controller pre-instantiation Promises. This top-level scope is inherited by all nested controller scopes, just like the '$rootScope' is.</em></strong></p>
<p>See <a href="https://github.com/imifos/sample-project-library/blob/master/topro-1/src/main/webapp/WEB-INF/jsp/main.jsp" target="_blank">main.jsp</a> and <a href="https://github.com/imifos/sample-project-library/blob/master/topro-1/src/main/webapp/js/controllers.js">controllers.js</a></p>
<div><div id="highlighter_534309" class="syntaxhighlighter nogutter tca xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">body</code> <code class="xml color1">ng-app</code><code class="xml plain">=</code><code class="xml string">"topro"</code> <code class="xml color1">ng-controller</code><code class="xml plain">=</code><code class="xml string">"AppController"</code><code class="xml plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">---</code></div><div class="line number3 index2 alt2"><code class="xml plain">app.controller("AppController",function AppController($scope) {</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">$scope.proposalTypes=initProposalTypes();</code></div><div class="line number5 index4 alt2"><code class="xml plain">});</code></div></div></td></tr></tbody></table></div></div>
<p><strong><em>*) How to prepare data via JSP templating that is then passed into AngualrJS controllers.</em></strong></p>
<p>See <a href="https://github.com/imifos/sample-project-library/blob/master/topro-1/src/main/java/eu/lucubratory/topro1/front/res/page/MainPageResource.java" target="_blank">MainPageResource</a>, <a href="https://github.com/imifos/sample-project-library/blob/master/topro-1/src/main/webapp/WEB-INF/jsp/main.jsp" target="_blank">main.jsp</a> and <a href="https://github.com/imifos/sample-project-library/blob/master/topro-1/src/main/webapp/js/controllers.js">controllers.js</a></p>
<div><div id="highlighter_395096" class="syntaxhighlighter nogutter tca java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">MainPageResource {</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Inject</code> <code class="java color1">@RawJsonMapper</code> <code class="java plain">ObjectMapper rawJsonMapper;</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java color1">@GET</code></div><div class="line number6 index5 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Path</code><code class="java plain">(</code><code class="java string">"main"</code><code class="java plain">)</code></div><div class="line number7 index6 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java plain">Viewable index(</code><code class="java color1">@Context</code> <code class="java plain">HttpServletRequest request) {</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">List&lt;ProposalType&gt; proposalTypes=ProposalType.init();</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String jsonProposalTypes=</code><code class="java keyword">null</code><code class="java plain">;</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code> <code class="java plain">{</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">jsonProposalTypes=rawJsonMapper.writeValueAsString(proposalTypes);</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">catch</code> <code class="java plain">(IOException&nbsp; ex) {</code></div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">throw</code> <code class="java keyword">new</code> <code class="java plain">WebApplicationException(Status.INTERNAL_SERVER_ERROR);</code></div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">request.setAttribute(</code><code class="java string">"proposalTypes"</code><code class="java plain">,jsonProposalTypes);</code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java keyword">new</code> <code class="java plain">Viewable(</code><code class="java string">"/main.jsp"</code><code class="java plain">, </code><code class="java keyword">null</code><code class="java plain">);</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="java plain">---</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="java plain">main.jsp:</code></div><div class="line number27 index26 alt2"><code class="java plain">&lt;body ng-app=</code><code class="java string">"topro"</code> <code class="java plain">ng-controller=</code><code class="java string">"AppController"</code><code class="java plain">&gt;</code></div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java plain">:</code></div><div class="line number29 index28 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java plain">&lt;%-- EAGER DATA INITIALISATION --%&gt;</code></div><div class="line number30 index29 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java plain">:</code></div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java plain">&lt;script type=</code><code class="java string">"text/javascript"</code><code class="java plain">&gt;</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">function initProposalTypes() {</code></div><div class="line number33 index32 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java plain">&lt;c:out value=</code><code class="java string">"${proposalTypes}"</code> <code class="java plain">escapeXml=</code><code class="java string">"false"</code><code class="java plain">/&gt;</code></div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java plain">&lt;/script&gt;</code></div><div class="line number36 index35 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java plain">:</code></div><div class="line number37 index36 alt2">&nbsp;</div><div class="line number38 index37 alt1"><code class="java plain">---</code></div><div class="line number39 index38 alt2">&nbsp;</div><div class="line number40 index39 alt1"><code class="java plain">app.controller(</code><code class="java string">"AppController"</code><code class="java plain">,function AppController($scope) {</code></div><div class="line number41 index40 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">$scope.proposalTypes=initProposalTypes();</code></div><div class="line number42 index41 alt1"><code class="java plain">});</code></div></div></td></tr></tbody></table></div></div>
<p><strong><em>*) How to define a Service/Factory, in this case to perform REST operations using the ngResources module of AngularJS. 'ngResource' is declared as a module dependency and injected by AngularJS.</em></strong></p>
<p>See <a href="https://github.com/imifos/sample-project-library/blob/master/topro-1/src/main/webapp/js/services.js">services.js</a></p>
<div><div id="highlighter_606493" class="syntaxhighlighter nogutter tca jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript plain">angular.module(</code><code class="jscript string">'topicsServices'</code><code class="jscript plain">, [</code><code class="jscript string">'ngResource'</code><code class="jscript plain">]).</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">factory(</code><code class="jscript string">'Topics'</code><code class="jscript plain">,</code><code class="jscript keyword">function</code><code class="jscript plain">($resource,AppContext){</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">// Returns the topics rest resource, replacing POST by PUT on the update operation.</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">// All other methods stay on the default behavior.</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">// <a href="http://docs.angularjs.org/api/ngResource.">http://docs.angularjs.org/api/ngResource.</a>$resource</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">$resource(AppContext+</code><code class="jscript string">'/res/topics/:id'</code><code class="jscript plain">, {}, { update: {method:</code><code class="jscript string">'POST'</code><code class="jscript plain">} });</code></div><div class="line number8 index7 alt1"><code class="jscript plain">});</code></div></div></td></tr></tbody></table></div></div>
<p>In this case, we declare the factory in an different module (i.e. 'topicsServices') than the main.jsp page module (i.e.'topro') - this is optional. The factory() method of the module object registers a value factory, i.e. a Provider, under the name 'topicsProvider'. Each time we inject the 'Topics' service, AngularJS looks for a 'topicsProvider' in its registry ($injector).</p>
<p>There is actually a difference between a Service and a Factory. A Factory represents an object that has a single method: get(). The result of this getter is injected. A Service on the other hand is an injectable constructor. It injects an entire singletone (!) object which can be used to share stuff, data, methods, behavior, event buses between scopes. Under the surface, Services use the Factory mechanism, which uses &nbsp;the '$provide' AngularJS service.</p>
<p>About dependency injection (DI), the question arises how to implement DI in a weakly-typed environment. Since one cannot rely on types to find what has to be injected (like in Java), AngularJS uses variable names instead. Injecting for example '$scope' or 'Topics' in a controller makes AngularJS looking for a '$scopeProvider' or 'topicsProvider' respectively ($injector). The $ sign is just part of the variable name and a naming convention to indicate that the information is coming from the AngulaJS framework. It's the AngularJS namespace.</p>
<p><strong><em>*) How to use a filter for data transformation (like translation):</em></strong></p>
<p>See <a href="https://github.com/imifos/sample-project-library/blob/master/topro-1/src/main/webapp/WEB-INF/jsp/main.jsp" target="_blank">main.jsp</a> and <a href="https://github.com/imifos/sample-project-library/blob/master/topro-1/src/main/webapp/js/filters.js">filters.js</a></p>
<div><div id="highlighter_607593" class="syntaxhighlighter nogutter tca xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">:</code></div><div class="line number2 index1 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">h2</code><code class="xml plain">&gt;Proposed Topics&lt;/</code><code class="xml keyword">h2</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">div</code> <code class="xml color1">ng-repeat</code><code class="xml plain">=</code><code class="xml string">"topic in topics"</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">p</code> <code class="xml color1">style</code><code class="xml plain">=</code><code class="xml string">"font-size: 18px; font-style: oblique; font-weight:bold;"</code><code class="xml plain">&gt;{{topic.title}}&lt;</code><code class="xml keyword">p</code><code class="xml plain">/&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">p</code><code class="xml plain">&gt;{{topic.summary}}&lt;</code><code class="xml keyword">p</code><code class="xml plain">/&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">p</code><code class="xml plain">&gt;{{topic.proposalDate | date:'yyyy-MM-dd'}}&lt;</code><code class="xml keyword">p</code><code class="xml plain">/&gt;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">p</code> <code class="xml color1">style</code><code class="xml plain">=</code><code class="xml string">"font-size: 9px; font-style: oblique; "</code><code class="xml plain">&gt;{{topic.comment}}&lt;/</code><code class="xml keyword">p</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">p</code> <code class="xml color1">style</code><code class="xml plain">=</code><code class="xml string">"font-weight:bold;"</code><code class="xml plain">&gt;{{topic.type | pronounce:proposalTypes}}&lt;/</code><code class="xml keyword">p</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">div</code><code class="xml plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;</code><code class="xml plain">:</code></div><div class="line number11 index10 alt2"><code class="xml plain">---</code></div><div class="line number12 index11 alt1"><code class="xml plain">app.filter('pronounce', function() {</code></div><div class="line number13 index12 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">return function(id,idLabelArray) {</code></div><div class="line number14 index13 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">for (var i in idLabelArray) {</code></div><div class="line number15 index14 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">if (idLabelArray[i].id===id)</code></div><div class="line number16 index15 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">return idLabelArray[i].label;</code></div><div class="line number17 index16 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">}</code></div><div class="line number18 index17 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">return 'no_label_for_'+id;</code></div><div class="line number19 index18 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">}</code></div><div class="line number20 index19 alt1"><code class="xml plain">});</code></div></div></td></tr></tbody></table></div></div>
<p>It's not possible (afaik) to inject the surrounding scope into a filter. By this, it's not possible to take the translation reference data from the application scope, for example. This is rather a good design since filters should be kept independent of scopes. On the other hand, the '$rootScope', which is the scope associated with the "ng-app" level element, can be injected.</p>
<p>For more complex operations that require scopes, it's better to use services or scope methods directly.</p>
		
		
		





		
		
		
		
		
	  
	  </section>
    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Sample Projects Library maintained by <a href="https://github.com/imifos">Imifos</a></p>
      </footer>
    </div>

    

  </body>
</html>
